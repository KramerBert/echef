{% extends "base.html" %}
{% block content %}
<h2>Gerecht Bewerken: {{ gerecht.naam }}</h2>
<p>Categorie: {{ gerecht.categorie }}</p>
<p>Verkoopprijs: {{ gerecht.verkoopprijs if gerecht.verkoopprijs else 'n.v.t.' }}</p>

<!-- Formulier om alle velden bij te werken -->
<form method="POST" action="{{ url_for('edit_dish', chef_naam=chef_naam, dish_id=gerecht.dish_id) }}">
    <input type="hidden" name="updateForm" value="1">

    <h3>Naam bijwerken</h3>
    <input type="text" id="naam" name="naam" value="{{ gerecht.naam }}" required><br><br>

    <hr>

    <h3>Beschrijving bijwerken</h3>
    <textarea id="beschrijving" name="beschrijving" rows="4" cols="50" required>{{ gerecht.beschrijving if gerecht.beschrijving else '' }}</textarea><br><br>

    <hr>

    <h3>Verkoopprijs bijwerken</h3>
    <input type="number" step="0.01" id="verkoopprijs" name="verkoopprijs" value="{{ gerecht.verkoopprijs }}" required><br><br>

    <hr>

    <h3>Categorie bijwerken</h3>
    <select id="gerecht_categorie" name="gerecht_categorie" required>
        <option value="Amuse-bouche" {% if gerecht.categorie == 'Amuse-bouche' %}selected{% endif %}>Amuse-bouche (optioneel)</option>
        <option value="Hors-d'œuvre" {% if gerecht.categorie == "Hors-d'œuvre" %}selected{% endif %}>Hors-d'œuvre (koud voorgerecht)</option>
        <option value="Potage" {% if gerecht.categorie == 'Potage' %}selected{% endif %}>Potage (soep)</option>
        <option value="Poisson" {% if gerecht.categorie == 'Poisson' %}selected{% endif %}>Poisson (visgerecht)</option>
        <option value="Entrée" {% if gerecht.categorie == 'Entrée' %}selected{% endif %}>Entrée (warm voorgerecht / tussengerecht)</option>
        <option value="Sorbet" {% if gerecht.categorie == 'Sorbet' %}selected{% endif %}>Sorbet (verfrissende gang)</option>
        <option value="Relevé of Rôti" {% if gerecht.categorie == 'Relevé of Rôti' %}selected{% endif %}>Relevé of Rôti (hoofdgerecht/vleesgerecht)</option>
        <option value="Légumes / Groentegerecht" {% if gerecht.categorie == 'Légumes / Groentegerecht' %}selected{% endif %}>Légumes / Groentegerecht (optioneel apart geserveerd)</option>
        <option value="Salade" {% if gerecht.categorie == 'Salade' %}selected{% endif %}>Salade (optioneel apart)</option>
        <option value="Fromage" {% if gerecht.categorie == 'Fromage' %}selected{% endif %}>Fromage (kaas)</option>
        <option value="Entremets" {% if gerecht.categorie == 'Entremets' %}selected{% endif %}>Entremets (zoet nagerecht)</option>
        <option value="Café / Mignardises" {% if gerecht.categorie == 'Café / Mignardises' %}selected{% endif %}>Café / Mignardises</option>
        <option value="Digestief" {% if gerecht.categorie == 'Digestief' %}selected{% endif %}>Digestief (optioneel)</option>
        <option value="Basisgerecht" {% if gerecht.categorie == 'Basisgerecht' %}selected{% endif %}>Basisgerecht</option>
    </select><br><br>

    <hr>

    <h3>Bereidingswijze bijwerken</h3>
    <textarea id="bereidingswijze" name="bereidingswijze" rows="6" cols="50">{{ gerecht.bereidingswijze if gerecht.bereidingswijze else '' }}</textarea><br><br>

    <hr>

    <button type="submit">Opslaan</button>
</form>

<hr>

<h3>Ingrediënten toevoegen</h3>
<form method="POST" action="{{ url_for('edit_dish', chef_naam=chef_naam, dish_id=gerecht.dish_id) }}" style="display: flex; align-items: center;">
    <input type="hidden" name="ingredientForm" value="1">

    <label for="ingredient_id">Ingrediënt:</label>
    <select id="ingredient_id" name="ingredient_id" required>
        <option value="" disabled selected>Selecteer Ingrediënt</option>
        {% for ingr in alle_ingredienten %}
        <option value="{{ ingr.ingredient_id }}">{{ ingr.naam }} ({{ ingr.eenheid }})</option>
        {% endfor %}
    </select>

    <label for="hoeveelheid" style="margin-left: 10px;">Hoeveelheid:</label>
    <input type="number" step="0.01" id="hoeveelheid" name="hoeveelheid" required style="margin-left: 10px;">

    <button type="submit" style="margin-left: 10px;">Ingrediënt toevoegen</button>
</form>

<hr>

<!-- Lijst van ingrediënten die al zijn gekoppeld aan dit gerecht -->
<h3>Kostprijsberekening:</h3>
{% if gerecht_ingredienten %}
<table border="1" cellpadding="5" cellspacing="0">
    <tr>
        <th>Ingrediënt</th>
        <th>Hoeveelheid</th>
        <th>Eenheid</th>
        <th>Prijs Totaal</th>
    </tr>
    {% for gi in gerecht_ingredienten %}
    <tr>
        <td>{{ gi.ingredient_naam }}</td>
        <td>{{ gi.hoeveelheid }}</td>
        <td>{{ gi.eenheid }}</td>
        <td>{{ gi.prijs_totaal }}</td>
    </tr>
    {% endfor %}
</table>
<p><strong>Totaal kostprijs: € {{ totaal_ingredient_prijs }}</strong></p>
{% else %}
<p>Er zijn nog geen ingrediënten aan dit gerecht toegevoegd.</p>
{% endif %}

<hr>

<a href="{{ url_for('manage_dishes', chef_naam=chef_naam) }}">Terug naar Gerechtenoverzicht</a>
{% endblock %}
