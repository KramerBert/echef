{% extends "layout.html" %}
{% block content %}
    <div class="container mt-4">
        <h2>Voorvertoning Recept</h2>
        
        {% set recipe_parts = recipe.split('\n\n') %}
        
        {% for part in recipe_parts %}
            {% if part.startswith('TITLE:') %}
                <h1 class="mb-4">{{ part.replace('TITLE:', '').strip() }}</h1>
            {% elif part.startswith('DESCRIPTION:') %}
                <h2 class="h4 mb-4">{{ part.replace('DESCRIPTION:', '').strip() }}</h2>
            {% elif part.startswith('INGREDIENTS:') %}
                <h3>Ingrediënten</h3>
                <ul class="list-unstyled mb-4">
                    {% for line in part.replace('INGREDIENTS:', '').strip().split('\n') %}
                        {% if line.strip().startswith('-') %}
                            <li>{{ line.strip().replace('-', '•', 1) }}</li>
                        {% endif %}
                    {% endfor %}
                </ul>
            {% elif part.startswith('INSTRUCTIONS:') %}
                <h3>Bereidingswijze</h3>
                <ol class="mb-4">
                    {% for line in part.replace('INSTRUCTIONS:', '').strip().split('\n') %}
                        {% if line.strip() and line.strip()[0].isdigit() %}
                            <li>{{ line.strip().split('.', 1)[1].strip() }}</li>
                        {% endif %}
                    {% endfor %}
                </ol>
            {% elif part.startswith('NOTES:') %}
                <h4>Tips & Opmerkingen</h4>
                <p class="mb-4">{{ part.replace('NOTES:', '').strip() }}</p>
            {% endif %}
        {% endfor %}

        <div class="mt-4 d-flex justify-content-between">
            <form method="POST" action="{{ url_for('ai.generate_recipe') }}">
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                <button type="submit" class="btn btn-secondary">Nieuw recept genereren</button>
            </form>
            
            <form method="POST" action="{{ url_for('ai.save_recipe') }}">
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                <button type="submit" class="btn btn-primary">Recept opslaan</button>
            </form>
        </div>
    </div>
{% endblock %}
