{% extends "base.html" %}
{% block content %}
<div class="container mt-4">
    <div class="row mb-4">
        <div class="col-12">
            <h1 class="dashboard-title">Ingrediënt Bewerken: {{ ingredient.naam }}</h1>
        </div>
    </div>

    <div class="edit-card">
        <form method="POST" action="{{ url_for('edit_ingredient', chef_naam=chef_naam, ingredient_id=ingredient.ingredient_id) }}" class="edit-ingredient-form">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            
            <div class="form-group">
                <label for="naam">Naam ingrediënt</label>
                <input type="text" id="naam" name="naam" value="{{ ingredient.naam }}" class="form-control" required>
            </div>

            <div class="form-group">
                <label for="categorie">Categorie</label>
                <input type="text" id="categorie" name="categorie" value="{{ ingredient.categorie }}" class="form-control" required>
            </div>

            <div class="form-group">
                <label for="eenheid">Eenheid</label>
                <select id="eenheid" name="eenheid" class="form-control" required>
                    <option value="gram (g)" {% if ingredient.eenheid == 'gram (g)' %}selected{% endif %}>gram (g)</option>
                    <option value="kilogram (kg)" {% if ingredient.eenheid == 'kilogram (kg)' %}selected{% endif %}>kilogram (kg)</option>
                    <option value="milliliter (ml)" {% if ingredient.eenheid == 'milliliter (ml)' %}selected{% endif %}>milliliter (ml)</option>
                    <option value="centiliter (cl)" {% if ingredient.eenheid == 'centiliter (cl)' %}selected{% endif %}>centiliter (cl)</option>
                    <option value="deciliter (dl)" {% if ingredient.eenheid == 'deciliter (dl)' %}selected{% endif %}>deciliter (dl)</option>
                    <option value="liter (l)" {% if ingredient.eenheid == 'liter (l)' %}selected{% endif %}>liter (l)</option>
                    <option value="theelepel (tl or tsp)" {% if ingredient.eenheid == 'theelepel (tl or tsp)' %}selected{% endif %}>theelepel (tl or tsp) – ca. 5 ml</option>
                    <option value="eetlepel (el or tbsp)" {% if ingredient.eenheid == 'eetlepel (el or tbsp)' %}selected{% endif %}>eetlepel (el or tbsp) – ca. 15 ml</option>
                    <option value="mespuntje" {% if ingredient.eenheid == 'mespuntje' %}selected{% endif %}>mespuntje</option>
                    <option value="snufje" {% if ingredient.eenheid == 'snufje' %}selected{% endif %}>snufje</option>
                    <option value="scheutje" {% if ingredient.eenheid == 'scheutje' %}selected{% endif %}>scheutje</option>
                    <option value="kopje" {% if ingredient.eenheid == 'kopje' %}selected{% endif %}>kopje ±125–150 ml</option>
                    <option value="mok" {% if ingredient.eenheid == 'mok' %}selected{% endif %}>mok (200–300 ml of meer)</option>
                    <option value="stuk/stuks" {% if ingredient.eenheid == 'stuk/stuks' %}selected{% endif %}>stuk/stuks</option>
                    <option value="pak" {% if ingredient.eenheid == 'pak' %}selected{% endif %}>pak</option>
                </select>
            </div>

            <div class="form-group">
                <label for="prijs_per_eenheid">Prijs per eenheid (€)</label>
                <input type="number" step="0.01" id="prijs_per_eenheid" name="prijs_per_eenheid" value="{{ ingredient.prijs_per_eenheid }}" class="form-control" required>
            </div>

            <div class="form-group">
                <label for="leverancier_id">Leverancier</label>
                <select id="leverancier_id" name="leverancier_id" class="form-control">
                    <option value="">Geen leverancier</option>
                    {% for leverancier in leveranciers %}
                        <option value="{{ leverancier.leverancier_id }}" 
                            {% if ingredient.leverancier_id == leverancier.leverancier_id %}selected{% endif %}>
                            {{ leverancier.naam }}
                        </option>
                    {% endfor %}
                </select>
            </div>

            <div class="button-group">
                <button type="submit" class="dashboard-btn">
                    <i class="fas fa-save"></i> Bijwerken
                </button>
                <a href="{{ url_for('manage_ingredients', chef_naam=chef_naam) }}" class="dashboard-btn secondary">
                    <i class="fas fa-arrow-left"></i> Terug naar Overzicht
                </a>
            </div>
        </form>
    </div>

    {% if gerechten_met_ingredient %}
    <div class="usage-card mt-4">
        <h3>Dit ingrediënt wordt gebruikt in de volgende gerechten:</h3>
        <div class="table-responsive">
            <table class="usage-table">
                <thead>
                    <tr>
                        <th>Gerecht</th>
                        <th>Hoeveelheid</th>
                        <th>Nieuwe Kostprijs</th>
                    </tr>
                </thead>
                <tbody>
                    {% for gerecht in gerechten_met_ingredient %}
                    <tr>
                        <td>{{ gerecht.naam }}</td>
                        <td>{{ gerecht.hoeveelheid }} {{ ingredient.eenheid }}</td>
                        <td>€ {{ gerecht.prijs_totaal }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    {% endif %}
</div>

<style>
    .edit-card, .usage-card {
        background-color: var(--kitchen-dark);
        border: 1px solid var(--kitchen-steel);
        border-radius: 8px;
        padding: 2rem;
        margin-bottom: 1.5rem;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .edit-ingredient-form .form-group {
        margin-bottom: 1.5rem;
    }

    .button-group {
        display: flex;
        gap: 1rem;
        margin-top: 2rem;
    }

    .button-group .dashboard-btn {
        flex: 1;
        max-width: 250px;
    }

    .dashboard-btn.secondary {
        background: linear-gradient(145deg, var(--kitchen-dark), var(--kitchen-steel));
    }

    .usage-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 1rem;
    }

    .usage-table th {
        background: linear-gradient(145deg, var(--kitchen-blue), var(--kitchen-dark));
        color: var(--text-light);
        padding: 1rem;
        text-align: left;
    }

    .usage-table td {
        padding: 1rem;
        border-bottom: 1px solid var(--kitchen-steel);
    }

    @media (max-width: 768px) {
        .edit-card, .usage-card {
            padding: 1rem;
        }

        .button-group {
            flex-direction: column;
        }

        .button-group .dashboard-btn {
            max-width: none;
        }

        .usage-table th, 
        .usage-table td {
            padding: 0.75rem;
        }
    }
</style>
{% endblock %}
